<!DOCTYPE html>

<html>
	<head>
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<script src="three.min.js"></script>
		<link rel="stylesheet" href="css/viu.css">
	</head>
	
	<body>
		<script>
			// construct and setup the scene
			
			var renderer = new THREE.WebGLRenderer( {antialias:true} );
				renderer.setAnimationLoop( animate );
				renderer.shadowMap.enabled = true;
				renderer.shadowMap.type = THREE.VSMShadowMap; 
				document.body.appendChild( renderer.domElement );

			var scene = new THREE.Scene();
				scene.background = new THREE.Color( 'white' );

			var camera = new THREE.PerspectiveCamera( 60, 1, 1, 1000 );
				camera.position.set( 0, 40, 100 );
				camera.lookAt( scene.position );
			
			var light = new THREE.PointLight( 'white', 0.5 );
				light.position.set( 0, 45, 90 );
				light.castShadow = true;
				light.shadow.mapSize.width = 8*128; // default
light.shadow.mapSize.height = 8*128; // default
light.shadow.camera.near = 10; // default
light.shadow.camera.far = 1000; // default
light.shadow.bias = -0.0005; // default

				scene.add( light );
				scene.add( new THREE.AmbientLight( 'white', 0.5 ) );

			// manage rezie
			
			window.addEventListener( 'resize', onWindowResize, false );
			onWindowResize();
			
			function onWindowResize( event )
			{
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight, true );
			}			

			var mainFrame = new THREE.Group();
				scene.add( mainFrame );
				
			// animation loop

			function animate( time )
			{
				// slow rotation of the cube
				scene.rotation.set( 0, time/2000, 0 );
				
				renderer.render( scene, camera );
			}
			
		</script>

		<script>

			// triangle sides
			
			const A = 30;
			const B = 40;
			const C = Math.sqrt(A*A+B*B);

			// other parameters
			
			const FRAME_WIDTH = 5;
			const BASE_HEIGHT = 3;
			const FRAME_RADIUS = 4;
			const FRAME_SIZE = A+B+2*FRAME_WIDTH;
			
			mainFrame.rotation.x = -Math.PI/2;
			mainFrame.position.set( -FRAME_SIZE/2, 0, FRAME_SIZE/2 );
			// materials
			
			//https://www.wildtextures.com/free-textures/just-a-simple-seamless-concrete-texture/
			texture = new THREE.TextureLoader().load( 'wildtextures-seamless-industrial-concrete-texture.jpg' );
			texture.wrapS = THREE.RepeatWrapping;
texture.wrapT = THREE.RepeatWrapping;
texture.repeat.set( 1/64, 1/64 );

//scene.background = texture;

			var mainMaterial = new THREE.MeshStandardMaterial( {
										color: 'white',
										emissive: 'tan',
										emissiveIntensity: 0.1,
										map: texture,
										//envMap: texture2,
    roughness: 0.6,
    metalness: 0.1,
										side: THREE.DoubleSide,
									} );

			// base of the model

			var S = FRAME_SIZE,
				G = FRAME_RADIUS;
			
			var shape = new THREE.Shape();
				shape.moveTo( 0, S/2 );
				shape.lineTo( 0, S-G );
				shape.quadraticCurveTo( 0, S, G, S );
				shape.lineTo( S-G, S );
				shape.quadraticCurveTo( S, S, S, S-G );
				shape.lineTo( S, G );
				shape.quadraticCurveTo( S, 0, S-G, 0 );
				shape.lineTo( G, 0 );
				shape.quadraticCurveTo( 0, 0, 0, G );
				shape.lineTo( 0, S/2 );

			var extrudeSettings = {
				steps: 1,
				depth: BASE_HEIGHT,
				bevelEnabled: false,
				//bevelThickness: 1,
				//bevelSize: 1,
				//bevelOffset: 0,
				//bevelSegments: 8
			};

			var geometry = new THREE.ExtrudeGeometry( shape, extrudeSettings );
			var base = new THREE.Mesh( geometry, mainMaterial );
				mainFrame.add( base );
				base.castShadow = true;
				base.receiveShadow = true;

			// frame of the model

			var F = FRAME_WIDTH;

			var hole = new THREE.Path();
				hole.moveTo( 0+F, S/2 );
				hole.lineTo( 0+F, S-G-F );
				hole.quadraticCurveTo( 0+F, S-F, G+F, S-F );
				hole.lineTo( S-G-F, S-F );
				hole.quadraticCurveTo( S-F, S-F, S-F, S-G-F );
				hole.lineTo( S-F, G+F );
				hole.quadraticCurveTo( S-F, 0+F, S-G-F, 0+F );
				hole.lineTo( G+F, 0+F );
				hole.quadraticCurveTo( 0+F, 0+F, 0+F, G+F );
				hole.lineTo( 0+F, S/2 );
				
				shape.holes = [hole];

			var extrudeSettings = {
				steps: 1,
				depth: 2*BASE_HEIGHT,
				bevelEnabled: false,
				//bevelThickness: 1,
				//bevelSize: 1,
				//bevelOffset: 0,
				//bevelSegments: 8
			};

			geometry = new THREE.ExtrudeGeometry( shape, extrudeSettings );
			var frame = new THREE.Mesh( geometry, mainMaterial );
				mainFrame.add( frame );
			frame.position.z = BASE_HEIGHT;
				frame.castShadow = true;
				frame.receiveShadow = true;
		</script>
		
	</body>
</html>


